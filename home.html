<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Ch·ªß - Ho·∫°t ƒë·ªông chung</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background-color: #f4f4f4; }
        .nav-bar { background-color: #333; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .user-info { display: flex; align-items: center; }
        .logout-btn { background-color: #dc3545; color: white; border: none; padding: 8px 15px; cursor: pointer; border-radius: 4px; margin-left: 15px; }
        .logout-btn:hover { background-color: #c82333; }
        .content { padding: 20px; max-width: 900px; margin: 20px auto; background-color: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .admin-link { color: #007bff; text-decoration: none; font-weight: bold; margin-top: 10px; display: inline-block; }
    </style>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="nav-bar">
        <h1>C·ª≠a h√†ng Anhtu</h1>
        <div class="user-info">
            <span id="welcome-message">Xin ch√†o, Kh√°ch h√†ng!</span>
            <button id="logout-btn" class="logout-btn">ƒêƒÉng Xu·∫•t</button>
        </div>
    </div>

    <div class="content">
        <p>B·∫°n ƒë√£ ƒëƒÉng nh·∫≠p th√†nh c√¥ng.</p>
        <p>T√™n ƒëƒÉng nh·∫≠p c·ªßa b·∫°n: <strong id="username-display"></strong></p>
        <p>Quy·ªÅn truy c·∫≠p c·ªßa b·∫°n: <strong id="user-role"></strong></p>
        <a href="admin.html">B·∫°n l√† ng∆∞·ªùi qu·∫£n tr·ªã? truy c·∫≠p</a>
        
        <a id="admin-link" href="admin.html" class="admin-link" style="display: none;">Truy c·∫≠p Trang Qu·∫£n Tr·ªã</a>
    </div>

    <div class="header">
        <h1>üõí Danh s√°ch S·∫£n ph·∫©m</h1>
        <div>
            <a href="home.html">Quay l·∫°i Trang Ch·ªß</a> | <span id="auth-status">ƒêang t·∫£i...</span>
        </div>
    </div>
    
    <div class="cart-section">
        <h3>Gi·ªè h√†ng (<span id="cart-count">0</span>) | T·ªïng ti·ªÅn: <span id="cart-total-display">0.00</span> VNƒê</h3>
        <ul id="cart-items"></ul>

        <div class="order-form-container" style="margin-top: 20px;">
            <h4>Th√¥ng tin ƒê·∫∑t h√†ng</h4>
            <form id="order-form">
                <input type="text" id="order-name" placeholder="T√™n ng∆∞·ªùi nh·∫≠n" required>
                <textarea id="order-address" placeholder="ƒê·ªãa ch·ªâ giao h√†ng" required></textarea>
                <input type="text" id="order-phone" placeholder="S·ªë ƒëi·ªán tho·∫°i" required>
                <button type="button" id="submit-order-btn" class="add-btn">X√°c nh·∫≠n ƒê·∫∑t h√†ng</button>
            </form>
            <div id="order-status"></div>
        </div>
    </div>
    

    <script>
        // --- LOGIC X√ÅC MINH PHI√äN (Ch·∫°y khi t·∫£i trang) ---
        // --- LOGIC X√ÅC MINH PHI√äN (Ch·∫°y khi t·∫£i trang) ---
    function checkAuthStatus() {
        const token = localStorage.getItem('authToken');
        const username = localStorage.getItem('tendangnhap'); // ƒê·ªåC KH√ìA ƒê√öNG
        const role = localStorage.getItem('role');

        if (!token) {
            window.location.href = "index.html";
            return;
        }

        // --- HI·ªÇN TH·ªä TH√îNG TIN USER ƒê√É ƒêƒÇNG NH·∫¨P ---
        document.getElementById('welcome-message').textContent = `Xin ch√†o, ${username || 'User'}!`;
        document.getElementById('username-display').textContent = username;
        
        // KH·∫ÆC PH·ª§C L·ªñI "UNDEFINED":
        const displayRole = role || "Kh√¥ng x√°c ƒë·ªãnh"; 
        document.getElementById('user-role').textContent = displayRole;

        // --- LOGIC ADMIN ---
        if (role === 'ADMIN') { 
            document.getElementById('admin-link').style.display = 'inline-block';
        }
    }

        // --- LOGIC ƒêƒÇNG XU·∫§T ---
        document.getElementById('logout-btn').addEventListener('click', () => {
            // X√≥a t·∫•t c·∫£ c√°c kh√≥a li√™n quan ƒë·∫øn phi√™n ƒë√£ l∆∞u trong index.html
            localStorage.removeItem('authToken');
            localStorage.removeItem('tendangnhap');
            localStorage.removeItem('role');
            localStorage.removeItem('userId'); 

            // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ƒêƒÉng nh·∫≠p
            window.location.href = "index.html";
        });

        // Kh·ªüi t·∫°o ki·ªÉm tra x√°c th·ª±c khi trang Home t·∫£i
        checkAuthStatus();
    </script>
</body>
</html>